---
/**
 * Open Source Projects Section
 * Card grid of open-source projects with 3D tilt, glow hover,
 * and full-card click-through.
 *
 * @depends config.projects, ArrowIcon
 * @styles Scoped SCSS — project grid, cards, tags + responsive
 */
import SectionHeader from './SectionHeader.astro';
import ArrowIcon from './ArrowIcon.astro';
import { config } from '@config/index';

const base = import.meta.env.BASE_URL.replace(/\/?$/, '/');
---

<!-- ══════ OPEN SOURCE ══════ -->
<section id="projects" class="section">
  <SectionHeader label="// What I've built" title="Open Source & Community" />
  <div class="projects-grid stagger">
    {config.projects.map((project) => (
      <div class="project-card glass reveal glow-border" data-tilt>
        <div class="project-icon"><img src={project.iconIsLocal ? `${base}${project.icon}` : project.icon} alt={project.name} /></div>
        <h3 class="project-name"><a href={project.url} target="_blank" rel="noopener">{project.name}</a></h3>
        <p class="project-desc" set:html={project.description} />
        <div class="project-tags">
          {project.tags.map((tag) => (
            <span>{tag}</span>
          ))}
        </div>
        <a href={project.url} target="_blank" rel="noopener" class="project-link">
          {project.linkText} <ArrowIcon />
        </a>
      </div>
    ))}
  </div>
</section>

<style lang="scss">
  @use '../styles/mixins' as *;

  .projects-grid {
    @include responsive-grid;
  }

  .project-card {
    @include card-padding;
    transition: all var(--duration-slow) var(--ease-out-expo);
    transform-style: preserve-3d;
    perspective: 1000px;
    cursor: pointer;
  }

  .project-icon {
    font-size: 2rem;
    margin-bottom: 1rem;

    img {
      width: 44px; height: 44px;
      object-fit: contain;
    }
  }

  .project-name {
    font-size: 1.15rem;
    font-weight: 700;
    margin-bottom: 0.5rem;

    a {
      color: var(--text);
      transition: color var(--duration-normal);
      &:hover { color: var(--accent); }
    }
  }

  .project-desc {
    font-size: 0.9rem;
    color: var(--text-dim);
    line-height: 1.6;
    margin-bottom: 1rem;

    @include respond-to(mobile) { font-size: 0.85rem; }
  }

  .project-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 0.4rem;

    span {
      font-family: var(--font-mono);
      font-size: 0.7rem;
      padding: 0.2rem 0.6rem;
      border-radius: var(--radius-sm);
      background: rgba(var(--accent-blue-glow), 0.08);
      color: var(--accent-blue);
      border: 1px solid rgba(var(--accent-blue-glow), 0.15);

      @include respond-to(small) { font-size: 0.6rem; }
    }
  }

  .project-link {
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
    margin-top: 1rem;
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--accent);

    &:hover { color: var(--accent-mint); }

    :global(svg) { width: 16px; height: 16px; }
  }
</style>
